<?xml version="1.0" encoding="utf-8"?>
<modification>
	<code>brax_registro_pessoa</code>
	<name>BraxTI - Registro de Clientes</name>
	<version>1.00</version>
	<author>Leandro Anjos</author>
	<link>https://github.com/leandroanjos/opencart</link>   
	
	<file path="catalog/controller/account/register.php">			
		<operation>
			<search><![CDATA[$this->load->language('account/register');]]></search>
			<add position="before"><![CDATA[
				if ($this->config->get('module_brax_registro_pessoa_status')) {
					$this->response->redirect($this->url->link('extension/module/brax_registro_pessoa'));
				}
			]]></add>
			</operation>
	</file>
	
	<file path="admin/model/customer/customer_approval.php">			
		<operation>
			<search><![CDATA[c.`date_added` DESC";]]></search>
			<add position="after"><![CDATA[
				if ($this->config->get('module_brax_registro_pessoa_status')) {
					$str_register_name = "CONCAT(\"<b>Nome: </b>\", brp.`nome`, "
						."\"<br><b>Raz√£o Social: </b>\", brp.`razao_social`,  "
						."\"<br><b>CPF/CNPJ: </b>\", brp.`doc`, "
						."\"<br><b>RG/IE: </b>\", brp.`rgie`, "
						."\"<br><b>Fone: </b>\", c.`telephone`) AS name";

					$str_register_join = "customer_approval` ca  LEFT JOIN `oc_brax_registro_pessoa` brp ON (ca.`customer_id` = brp.`customer_id`)	 ";
						
					$sql = str_replace("CONCAT(c.`firstname`, ' ', c.`lastname`) AS name", $str_register_name, $sql);
					$sql = str_replace("customer_approval` ca", $str_register_join, $sql);
				}
			]]></add>
			</operation>
	</file>
</modification>